import { Decoder } from "./codec/tlsDecoder.js";
import { Encoder } from "./codec/tlsEncoder.js";
import { ContentTypeValue } from "./contentType.js";
import { CiphersuiteImpl } from "./crypto/ciphersuite.js";
import { Kdf } from "./crypto/kdf.js";
import { KeyRetentionConfig } from "./keyRetentionConfig.js";
import { ReuseGuard, SenderData } from "./sender.js";
import { LeafIndex } from "./treemath.js";
/** @public */
export interface GenerationSecret {
    secret: Uint8Array;
    generation: number;
    unusedGenerations: Record<number, Uint8Array>;
}
export declare const generationSecretEncoder: Encoder<GenerationSecret>;
export declare const generationSecretDecoder: Decoder<GenerationSecret>;
/** @public */
export interface SecretTreeNode {
    handshake: GenerationSecret;
    application: GenerationSecret;
}
export declare const secretTreeNodeEncoder: Encoder<SecretTreeNode>;
export declare const secretTreeNodeDecoder: Decoder<SecretTreeNode>;
/** @public */
export interface SecretTree {
    leafWidth: number;
    intermediateNodes: Record<number, Uint8Array>;
    leafNodes: Record<number, SecretTreeNode>;
}
export declare const secretTreeEncoder: Encoder<SecretTree>;
export declare const secretTreeDecoder: Decoder<SecretTree>;
export declare function allSecretTreeValues(tree: SecretTree): Uint8Array[];
export interface ConsumeRatchetResult {
    nonce: Uint8Array;
    reuseGuard: ReuseGuard;
    key: Uint8Array;
    generation: number;
    newTree: SecretTree;
    consumed: Uint8Array[];
}
export declare function createSecretTree(leafWidth: number, encryptionSecret: Uint8Array): SecretTree;
export declare function deriveNonce(secret: Uint8Array, generation: number, cs: CiphersuiteImpl): Promise<Uint8Array>;
export declare function deriveKey(secret: Uint8Array, generation: number, cs: CiphersuiteImpl): Promise<Uint8Array>;
export declare function ratchetUntil(current: GenerationSecret, desiredGen: number, config: KeyRetentionConfig, kdf: Kdf): Promise<[GenerationSecret, Uint8Array[]]>;
export declare function derivePrivateMessageNonce(secret: Uint8Array, generation: number, reuseGuard: Uint8Array, cs: CiphersuiteImpl): Promise<Uint8Array>;
export declare function ratchetToGeneration(tree: SecretTree, senderData: SenderData, contentType: ContentTypeValue, config: KeyRetentionConfig, cs: CiphersuiteImpl): Promise<ConsumeRatchetResult>;
export declare function consumeRatchet(tree: SecretTree, index: LeafIndex, contentType: ContentTypeValue, cs: CiphersuiteImpl): Promise<ConsumeRatchetResult>;
export declare function createRatchetRoot(node: Uint8Array, label: string, kdf: Kdf): Promise<{
    secret: Uint8Array<ArrayBufferLike>;
    generation: number;
    unusedGenerations: {};
}>;
