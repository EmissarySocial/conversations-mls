import { Decoder } from "./codec/tlsDecoder.js";
import { Encoder } from "./codec/tlsEncoder.js";
import { Commit } from "./commit.js";
import { ContentTypeValue, contentTypes } from "./contentType.js";
import { CiphersuiteImpl } from "./crypto/ciphersuite.js";
import { Hash } from "./crypto/hash.js";
import { Signature } from "./crypto/signature.js";
import { GroupContext } from "./groupContext.js";
import { WireformatName, WireformatValue } from "./wireformat.js";
import { Proposal } from "./proposal.js";
import { ProtocolVersionValue } from "./protocolVersion.js";
import { Sender } from "./sender.js";
import { senderTypes } from "./sender.js";
/** @public */
export type FramedContentInfo = FramedContentApplicationData | FramedContentProposalData | FramedContentCommitData;
/** @public */
export interface FramedContentApplicationData {
    contentType: typeof contentTypes.application;
    applicationData: Uint8Array;
}
/** @public */
export interface FramedContentProposalData {
    contentType: typeof contentTypes.proposal;
    proposal: Proposal;
}
/** @public */
export interface FramedContentCommitData {
    contentType: typeof contentTypes.commit;
    commit: Commit;
}
export declare const framedContentApplicationDataEncoder: Encoder<FramedContentApplicationData>;
export declare const framedContentProposalDataEncoder: Encoder<FramedContentProposalData>;
export declare const framedContentCommitDataEncoder: Encoder<FramedContentCommitData>;
export declare const framedContentInfoEncoder: Encoder<FramedContentInfo>;
export declare const framedContentApplicationDataDecoder: Decoder<FramedContentApplicationData>;
export declare const framedContentProposalDataDecoder: Decoder<FramedContentProposalData>;
export declare const framedContentCommitDataDecoder: Decoder<FramedContentCommitData>;
export declare const framedContentInfoDecoder: Decoder<FramedContentInfo>;
export declare function toTbs(content: FramedContent, wireformat: WireformatValue, context: GroupContext): FramedContentTBS;
/** @public */
export type FramedContent = FramedContentData & FramedContentInfo;
/** @public */
export interface FramedContentData {
    groupId: Uint8Array;
    epoch: bigint;
    sender: Sender;
    authenticatedData: Uint8Array;
}
export type FramedContentCommit = FramedContentData & FramedContentCommitData;
export type FramedContentApplicationOrProposal = FramedContentData & (FramedContentApplicationData | FramedContentProposalData);
export declare const framedContentEncoder: Encoder<FramedContent>;
export declare const framedContentDecoder: Decoder<FramedContent>;
type SenderInfo = SenderInfoMember | SenderInfoNewMemberCommit | SenderInfoExternal | SenderInfoNewMemberProposal;
type SenderInfoMember = {
    senderType: typeof senderTypes.member;
    context: GroupContext;
};
type SenderInfoNewMemberCommit = {
    senderType: typeof senderTypes.new_member_commit;
    context: GroupContext;
};
type SenderInfoExternal = {
    senderType: typeof senderTypes.external;
};
type SenderInfoNewMemberProposal = {
    senderType: typeof senderTypes.new_member_proposal;
};
export declare const senderInfoEncoder: Encoder<SenderInfo>;
export type FramedContentTBS = {
    protocolVersion: ProtocolVersionValue;
    wireformat: WireformatValue;
    content: FramedContent;
} & SenderInfo;
export type FramedContentTBSCommit = FramedContentTBS & {
    content: FramedContentCommit;
};
export type FramedContentTBSApplicationOrProposal = FramedContentTBS & {
    content: FramedContentApplicationOrProposal;
};
export declare const framedContentTBSEncoder: Encoder<FramedContentTBS>;
/** @public */
export type FramedContentAuthData = FramedContentAuthDataCommit | FramedContentAuthDataApplicationOrProposal;
/** @public */
export type FramedContentAuthDataCommit = {
    signature: Uint8Array;
} & FramedContentAuthDataContentCommit;
/** @public */
export type FramedContentAuthDataApplicationOrProposal = {
    signature: Uint8Array;
} & FramedContentAuthDataContentApplicationOrProposal;
/** @public */
export type FramedContentAuthDataContentCommit = {
    contentType: typeof contentTypes.commit;
    confirmationTag: Uint8Array;
};
/** @public */
export type FramedContentAuthDataContentApplicationOrProposal = {
    contentType: typeof contentTypes.application | typeof contentTypes.proposal;
};
export declare const framedContentAuthDataEncoder: Encoder<FramedContentAuthData>;
export declare const framedContentAuthDataCommitDecoder: Decoder<FramedContentAuthDataContentCommit>;
export declare function framedContentAuthDataDecoder(contentType: ContentTypeValue): Decoder<FramedContentAuthData>;
export declare function verifyFramedContentSignature(signKey: Uint8Array, wireformat: WireformatValue, content: FramedContent, auth: FramedContentAuthData, context: GroupContext, s: Signature): Promise<boolean>;
export declare function signFramedContentTBS(signKey: Uint8Array, tbs: FramedContentTBS, s: Signature): Promise<Uint8Array>;
export declare function signFramedContentApplicationOrProposal(signKey: Uint8Array, tbs: FramedContentTBSApplicationOrProposal, cs: CiphersuiteImpl): Promise<FramedContentAuthDataApplicationOrProposal>;
export declare function createConfirmationTag(confirmationKey: Uint8Array, confirmedTranscriptHash: Uint8Array, h: Hash): Promise<Uint8Array>;
export declare function verifyConfirmationTag(confirmationKey: Uint8Array, tag: Uint8Array, confirmedTranscriptHash: Uint8Array, h: Hash): Promise<boolean>;
export declare function createContentCommitSignature(groupContext: GroupContext, wireformat: WireformatName, c: Commit, sender: Sender, authenticatedData: Uint8Array, signKey: Uint8Array, s: Signature): Promise<{
    framedContent: FramedContentCommit;
    signature: Uint8Array;
}>;
export {};
