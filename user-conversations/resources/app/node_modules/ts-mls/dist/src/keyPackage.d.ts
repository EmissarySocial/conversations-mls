import { Decoder } from "./codec/tlsDecoder.js";
import { Encoder } from "./codec/tlsEncoder.js";
import { CiphersuiteId, CiphersuiteImpl } from "./crypto/ciphersuite.js";
import { Hash } from "./crypto/hash.js";
import { Signature } from "./crypto/signature.js";
import { CustomExtension, LeafNodeExtension } from "./extension.js";
import { ProtocolVersionValue } from "./protocolVersion.js";
import { LeafNodeKeyPackage } from "./leafNode.js";
import { Capabilities } from "./capabilities.js";
import { Lifetime } from "./lifetime.js";
import { Credential } from "./credential.js";
/** @public */
export type KeyPackageTBS = {
    version: ProtocolVersionValue;
    cipherSuite: CiphersuiteId;
    initKey: Uint8Array;
    leafNode: LeafNodeKeyPackage;
    extensions: CustomExtension[];
};
export declare const keyPackageTBSEncoder: Encoder<KeyPackageTBS>;
export declare const keyPackageTBSDecoder: Decoder<KeyPackageTBS>;
/** @public */
export type KeyPackage = KeyPackageTBS & {
    signature: Uint8Array;
};
export declare const keyPackageEncoder: Encoder<KeyPackage>;
export declare const keyPackageDecoder: Decoder<KeyPackage>;
export declare function signKeyPackage(tbs: KeyPackageTBS, signKey: Uint8Array, s: Signature): Promise<KeyPackage>;
export declare function verifyKeyPackage(kp: KeyPackage, s: Signature): Promise<boolean>;
export declare function makeKeyPackageRef(value: KeyPackage, h: Hash): Promise<Uint8Array>;
/** @public */
export interface PrivateKeyPackage {
    initPrivateKey: Uint8Array;
    hpkePrivateKey: Uint8Array;
    signaturePrivateKey: Uint8Array;
}
/** @public */
export interface GenerateKeyPackageWithKeyParams {
    credential: Credential;
    capabilities?: Capabilities;
    lifetime?: Lifetime;
    extensions?: CustomExtension[];
    signatureKeyPair: {
        signKey: Uint8Array;
        publicKey: Uint8Array;
    };
    cipherSuite: CiphersuiteImpl;
    leafNodeExtensions?: LeafNodeExtension[];
}
/** @public */
export declare function generateKeyPackageWithKey(params: GenerateKeyPackageWithKeyParams): Promise<{
    publicPackage: KeyPackage;
    privatePackage: PrivateKeyPackage;
}>;
/** @public */
export interface GenerateKeyPackageParams {
    credential: Credential;
    capabilities?: Capabilities;
    lifetime?: Lifetime;
    extensions?: CustomExtension[];
    cipherSuite: CiphersuiteImpl;
    leafNodeExtensions?: LeafNodeExtension[];
}
/** @public */
export declare function generateKeyPackage(params: GenerateKeyPackageParams): Promise<{
    publicPackage: KeyPackage;
    privatePackage: PrivateKeyPackage;
}>;
