import { Capabilities } from "./capabilities.js";
import { Decoder } from "./codec/tlsDecoder.js";
import { Encoder } from "./codec/tlsEncoder.js";
import { Credential } from "./credential.js";
import { Signature } from "./crypto/signature.js";
import { LeafNodeExtension } from "./extension.js";
import { leafNodeSources } from "./leafNodeSource.js";
import { Lifetime } from "./lifetime.js";
/** @public */
export interface LeafNodeData {
    hpkePublicKey: Uint8Array;
    signaturePublicKey: Uint8Array;
    credential: Credential;
    capabilities: Capabilities;
}
export declare const leafNodeDataEncoder: Encoder<LeafNodeData>;
export declare const leafNodeDataDecoder: Decoder<LeafNodeData>;
/** @public */
export type LeafNodeInfoOmitted = LeafNodeInfoKeyPackage | LeafNodeInfoUpdateOmitted | LeafNodeInfoCommitOmitted;
/** @public */
export interface LeafNodeInfoUpdateOmitted {
    leafNodeSource: typeof leafNodeSources.update;
    extensions: LeafNodeExtension[];
}
/** @public */
export interface LeafNodeInfoCommitOmitted {
    leafNodeSource: typeof leafNodeSources.commit;
    parentHash: Uint8Array;
    extensions: LeafNodeExtension[];
}
/** @public */
export interface LeafNodeInfoKeyPackage {
    leafNodeSource: typeof leafNodeSources.key_package;
    lifetime: Lifetime;
    extensions: LeafNodeExtension[];
}
export declare const leafNodeInfoKeyPackageEncoder: Encoder<LeafNodeInfoKeyPackage>;
export declare const leafNodeInfoUpdateOmittedEncoder: Encoder<LeafNodeInfoUpdateOmitted>;
export declare const leafNodeInfoCommitOmittedEncoder: Encoder<LeafNodeInfoCommitOmitted>;
export declare const leafNodeInfoOmittedEncoder: Encoder<LeafNodeInfoOmitted>;
export declare const leafNodeInfoKeyPackageDecoder: Decoder<LeafNodeInfoKeyPackage>;
export declare const leafNodeInfoUpdateOmittedDecoder: Decoder<LeafNodeInfoUpdateOmitted>;
export declare const leafNodeInfoCommitOmittedDecoder: Decoder<LeafNodeInfoCommitOmitted>;
export declare const leafNodeInfoOmittedDecoder: Decoder<LeafNodeInfoOmitted>;
export type LeafNodeInfo = LeafNodeInfoKeyPackage | LeafNodeInfoUpdate | LeafNodeInfoCommit;
export type LeafNodeInfoUpdate = LeafNodeInfoUpdateOmitted & {
    groupId: Uint8Array;
    leafIndex: number;
};
export type LeafNodeInfoCommit = LeafNodeInfoCommitOmitted & {
    groupId: Uint8Array;
    leafIndex: number;
};
export declare const leafNodeInfoUpdateEncoder: Encoder<LeafNodeInfoUpdate>;
export declare const leafNodeInfoCommitEncoder: Encoder<LeafNodeInfoCommit>;
export declare const leafNodeInfoEncoder: Encoder<LeafNodeInfo>;
export declare const leafNodeInfoUpdateDecoder: Decoder<LeafNodeInfoUpdate>;
export declare const leafNodeInfoCommitDecoder: Decoder<LeafNodeInfoCommit>;
export type LeafNodeTBS = LeafNodeData & LeafNodeInfo;
export type LeafNodeTBSCommit = LeafNodeData & LeafNodeInfoCommit;
export type LeafNodeTBSKeyPackage = LeafNodeData & LeafNodeInfoKeyPackage;
export declare const leafNodeTBSEncoder: Encoder<LeafNodeTBS>;
/** @public */
export type LeafNode = LeafNodeData & LeafNodeInfoOmitted & {
    signature: Uint8Array;
};
export declare const leafNodeEncoder: Encoder<LeafNode>;
export declare const leafNodeDecoder: Decoder<LeafNode>;
/** @public */
export type LeafNodeKeyPackage = LeafNode & {
    leafNodeSource: typeof leafNodeSources.key_package;
};
export declare const leafNodeKeyPackageDecoder: Decoder<LeafNodeKeyPackage>;
/** @public */
export type LeafNodeCommit = LeafNode & {
    leafNodeSource: typeof leafNodeSources.commit;
};
export declare const leafNodeCommitDecoder: Decoder<LeafNodeCommit>;
/** @public */
export type LeafNodeUpdate = LeafNode & {
    leafNodeSource: typeof leafNodeSources.update;
};
export declare const leafNodeUpdateDecoder: Decoder<LeafNodeUpdate>;
export declare function signLeafNodeCommit(tbs: LeafNodeTBSCommit, signaturePrivateKey: Uint8Array, sig: Signature): Promise<LeafNodeCommit>;
export declare function signLeafNodeKeyPackage(tbs: LeafNodeTBSKeyPackage, signaturePrivateKey: Uint8Array, sig: Signature): Promise<LeafNodeKeyPackage>;
export declare function verifyLeafNodeSignature(leaf: LeafNode, groupId: Uint8Array, leafIndex: number, sig: Signature): Promise<boolean>;
export declare function verifyLeafNodeSignatureKeyPackage(leaf: LeafNodeKeyPackage, sig: Signature): Promise<boolean>;
